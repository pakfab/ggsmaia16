<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <title>QR Code Generator e Pak Fab</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    body {
      font-family: "Inter", sans-serif;
      background: #0b0c10;
      color: white;
      text-align: center;
      padding: 30px;
    }

    h1 {
      margin-bottom: 10px;
      color: #61dafb;
    }

    textarea, input {
      width: 90%;
      max-width: 500px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      margin: 10px 0;
      font-size: 1rem;
    }

    button {
      background: #471eec;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background: #6c3ffe;
    }

    .qr-container img {
      margin-top: 20px;
      width: 250px;
      border: 3px solid #61dafb;
      border-radius: 10px;
    }

    /* Loader overlay */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      visibility: hidden;
      opacity: 0;
      transition: visibility 0s, opacity 0.3s ease;
      z-index: 9999;
    }

    .overlay.show {
      visibility: visible;
      opacity: 1;
    }

    /* Loader style */
    .loader-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 180px;
      height: 180px;
      font-size: 1.2em;
      font-weight: 300;
      color: white;
      border-radius: 50%;
      background-color: transparent;
      user-select: none;
      position: relative;
    }

    .loader {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      background-color: transparent;
      animation: loader-rotate 2s linear infinite;
      z-index: 0;
    }

    @keyframes loader-rotate {
      0% {
        transform: rotate(90deg);
        box-shadow:
          0 10px 20px 0 #fff inset,
          0 20px 30px 0 #ad5fff inset,
          0 60px 60px 0 #471eec inset;
      }
      50% {
        transform: rotate(270deg);
        box-shadow:
          0 10px 20px 0 #fff inset,
          0 20px 10px 0 #d60a47 inset,
          0 40px 60px 0 #311e80 inset;
      }
      100% {
        transform: rotate(450deg);
        box-shadow:
          0 10px 20px 0 #fff inset,
          0 20px 30px 0 #ad5fff inset,
          0 60px 60px 0 #471eec inset;
      }
    }

    .loader-letter {
      display: inline-block;
      opacity: 0.4;
      transform: translateY(0);
      animation: loader-letter-anim 2s infinite;
      z-index: 1;
    }

    @keyframes loader-letter-anim {
      0%, 100% {
        opacity: 0.4;
        transform: translateY(0);
      }
      20% {
        opacity: 1;
        transform: scale(1.15);
      }
      40% {
        opacity: 0.7;
        transform: translateY(0);
      }
    }

    .loader-letter:nth-child(1){animation-delay:0s;}
    .loader-letter:nth-child(2){animation-delay:0.1s;}
    .loader-letter:nth-child(3){animation-delay:0.2s;}
    .loader-letter:nth-child(4){animation-delay:0.3s;}
    .loader-letter:nth-child(5){animation-delay:0.4s;}
    .loader-letter:nth-child(6){animation-delay:0.5s;}
    .loader-letter:nth-child(7){animation-delay:0.6s;}
    .loader-letter:nth-child(8){animation-delay:0.7s;}
    .loader-letter:nth-child(9){animation-delay:0.8s;}

  </style>
</head>
<body>
  <h1>QR Code Generator e Pak Fab</h1>
  <p>Kalo mau bikin 1 QR, ketik atau paste linknya. Kalo mau bikin banyak, bikin daftar yg dipisah 1 baris 1 link. hasilnya nanti jadi satu .ZIP</p>

  <textarea id="linkInput" rows="6" placeholder="https://contoh.com atau banyak link..."></textarea><br>
  <button onclick="generateQR()">GAAAASSSSSS Bikinin QR!</button>

  <div class="qr-container" id="qrContainer"></div>

  <!-- Loader overlay -->
  <div class="overlay" id="overlay">
    <div class="loader-wrapper">
      <span class="loader-letter">T</span>
      <span class="loader-letter">u</span>
      <span class="loader-letter">n</span>
      <span class="loader-letter">g</span>
      <span class="loader-letter">g</span>
      <span class="loader-letter">u</span>
      <span class="loader-letter">i</span>
      <span class="loader-letter">n</span>
      <div class="loader"></div>
    </div>
  </div>

  <script>
    async function generateQR() {
      const overlay = document.getElementById("overlay");
      const input = document.getElementById("linkInput").value.trim();
      const qrContainer = document.getElementById("qrContainer");
      qrContainer.innerHTML = "";

      if (!input) return alert("Masukkan link disini dahulu!");

      const links = input.split("\n").map(l => l.trim()).filter(l => l);
      overlay.classList.add("show");

      try {
        if (links.length === 1) {
          // SINGLE MODE
          const link = links[0];
          const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=1000x1000&data=${encodeURIComponent(link)}`;
          const response = await fetch(qrUrl);
          const blob = await response.blob();
          const url = URL.createObjectURL(blob);

          const img = document.createElement("img");
          img.src = url;
          qrContainer.appendChild(img);

          const a = document.createElement("a");
          a.href = url;
          a.download = `qr_${Math.random().toString(36).substring(2,8)}.png`;
          a.textContent = "Unduh PNG";
          a.style.display = "block";
          a.style.marginTop = "10px";
          qrContainer.appendChild(a);

          // Auto download
          a.click();

        } else {
          // BULK MODE
          const zip = new JSZip();
          let count = 0;

          for (const link of links) {
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=1000x1000&data=${encodeURIComponent(link)}`;
            const response = await fetch(qrUrl);
            const blob = await response.blob();
            const filename = `qr_${Math.random().toString(36).substring(2,8)}.png`;
            zip.file(filename, blob);
            count++;
          }

          const zipBlob = await zip.generateAsync({ type: "blob" });
          saveAs(zipBlob, `QR_Batch_${Date.now()}.zip`);
        }
      } catch (e) {
        alert("Lho apa ini: " + e.message);
      } finally {
        overlay.classList.remove("show");
      }
    }
  </script>
</body>
</html>
